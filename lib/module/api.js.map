{"version":3,"sources":["api.ts"],"names":["Base64","batchApi","sendEvents","config","events","updatedEvents","map","event","sentAt","Date","toISOString","fetch","method","body","JSON","stringify","batch","headers","encode","writeKey"],"mappings":"AACA,SAASA,MAAT,QAAuB,WAAvB;AACA,SAASC,QAAT,QAAyB,aAAzB;AAEA,OAAO,MAAMC,UAAU,GAAG,cAMpB;AAAA,MAN2B;AAC/BC,IAAAA,MAD+B;AAE/BC,IAAAA;AAF+B,GAM3B;AACJ,QAAMC,aAAa,GAAGD,MAAM,CAACE,GAAP,CAAYC,KAAD,KAAY,EAC3C,GAAGA,KADwC;AAE3CC,IAAAA,MAAM,EAAE,IAAIC,IAAJ,GAAWC,WAAX;AAFmC,GAAZ,CAAX,CAAtB;AAKA,QAAMC,KAAK,CAACV,QAAD,EAAW;AACpBW,IAAAA,MAAM,EAAE,MADY;AAEpBC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBC,MAAAA,KAAK,EAAEX;AADY,KAAf,CAFc;AAKpBY,IAAAA,OAAO,EAAE;AACP,uBAAkB,SAAQjB,MAAM,CAACkB,MAAP,CAAe,GAAEf,MAAM,CAACgB,QAAS,GAAjC,CAAqC,EADxD;AAEP,sBAAgB;AAFT;AALW,GAAX,CAAX;AAUD,CAtBM","sourcesContent":["import type { Config, SegmentEvent } from './types';\nimport { Base64 } from 'js-base64';\nimport { batchApi } from './constants';\n\nexport const sendEvents = async ({\n  config,\n  events,\n}: {\n  config: Config;\n  events: SegmentEvent[];\n}) => {\n  const updatedEvents = events.map((event) => ({\n    ...event,\n    sentAt: new Date().toISOString(),\n  }));\n\n  await fetch(batchApi, {\n    method: 'POST',\n    body: JSON.stringify({\n      batch: updatedEvents,\n    }),\n    headers: {\n      'Authorization': `Basic ${Base64.encode(`${config.writeKey}:`)}`,\n      'Content-Type': 'application/json',\n    },\n  });\n};\n"]}