{"version":3,"sources":["client.tsx"],"names":["React","createContext","useContext","defaultConfig","createLogger","SegmentClient","SovranStorage","createClient","config","logger","debug","enable","disable","clientConfig","segmentStore","writeKey","client","store","init","Context","AnalyticsProvider","children","useAnalytics","console","error","screen","track","args","log","identify","flush","group","alias","reset"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,UAA/B,QAAiD,OAAjD;AAEA,SAASC,aAAT,QAA8B,aAA9B;AAEA,SAASC,YAAT,QAA6B,UAA7B;AACA,SAASC,aAAT,QAA8B,aAA9B;AACA,SAASC,aAAT,QAA8B,WAA9B;AAEA,OAAO,MAAMC,YAAY,GAAIC,MAAD,IAAoB;AAC9C,QAAMC,MAAM,GAAGL,YAAY,EAA3B;;AACA,MAAI,QAAOI,MAAP,aAAOA,MAAP,uBAAOA,MAAM,CAAEE,KAAf,MAAyB,SAA7B,EAAwC;AACtC,QAAIF,MAAM,CAACE,KAAX,EAAkB;AAChBD,MAAAA,MAAM,CAACE,MAAP;AACD,KAFD,MAEO;AACLF,MAAAA,MAAM,CAACG,OAAP;AACD;AACF;;AACD,QAAMC,YAAY,GAAG,EAAE,GAAGV,aAAL;AAAoB,OAAGK;AAAvB,GAArB;AAEA,QAAMM,YAAY,GAAG,IAAIR,aAAJ,CAAkBE,MAAM,CAACO,QAAzB,CAArB;AAEA,QAAMC,MAAM,GAAG,IAAIX,aAAJ,CAAkB;AAC/BG,IAAAA,MAAM,EAAEK,YADuB;AAE/BJ,IAAAA,MAF+B;AAG/BQ,IAAAA,KAAK,EAAEH;AAHwB,GAAlB,CAAf;AAMAE,EAAAA,MAAM,CAACE,IAAP;AAEA,SAAOF,MAAP;AACD,CAtBM;AAwBP,MAAMG,OAAO,gBAAGlB,aAAa,CAAuB,IAAvB,CAA7B;AAEA,OAAO,MAAMmB,iBAAiB,GAAG,QAM3B;AAAA,MAN4B;AAChCJ,IAAAA,MADgC;AAEhCK,IAAAA;AAFgC,GAM5B;;AACJ,MAAI,CAACL,MAAL,EAAa;AACX,WAAO,IAAP;AACD;;AAED,sBAAO,oBAAC,OAAD,CAAS,QAAT;AAAkB,IAAA,KAAK,EAAEA;AAAzB,KAAkCK,QAAlC,CAAP;AACD,CAZM;AAcP,OAAO,MAAMC,YAAY,GAAG,MAAqB;AAC/C,QAAMN,MAAM,GAAGd,UAAU,CAACiB,OAAD,CAAzB;;AACA,MAAI,CAACH,MAAL,EAAa;AACXO,IAAAA,OAAO,CAACC,KAAR,CACE,gCADF,EAEE,+FAFF,EADW,CAMX;;AACA,WAAO,EAAP;AACD;;AACD,SAAO;AACLC,IAAAA,MAAM,EAAE;AAAA,aAAaT,MAAM,CAACS,MAAP,CAAc,YAAd,CAAb;AAAA,KADH;AAELC,IAAAA,KAAK,EAAE,YAAa;AAAA,wCAATC,IAAS;AAATA,QAAAA,IAAS;AAAA;;AAClBJ,MAAAA,OAAO,CAACK,GAAR,CAAY,QAAZ,EAAsBD,IAAtB;AACAX,MAAAA,MAAM,CAACU,KAAP,CAAa,GAAGC,IAAhB;AACD,KALI;AAMLE,IAAAA,QAAQ,EAAE;AAAA,aAAab,MAAM,CAACa,QAAP,CAAgB,YAAhB,CAAb;AAAA,KANL;AAOLC,IAAAA,KAAK,EAAE,MAAMd,MAAM,CAACc,KAAP,EAPR;AAQLC,IAAAA,KAAK,EAAE;AAAA,aAAaf,MAAM,CAACe,KAAP,CAAa,YAAb,CAAb;AAAA,KARF;AASLC,IAAAA,KAAK,EAAE;AAAA,aAAahB,MAAM,CAACgB,KAAP,CAAa,YAAb,CAAb;AAAA,KATF;AAULC,IAAAA,KAAK,EAAE,MAAMjB,MAAM,CAACiB,KAAP;AAVR,GAAP;AAYD,CAvBM","sourcesContent":["import React, { createContext, useContext } from 'react';\n\nimport { defaultConfig } from './constants';\nimport type { Config, ClientMethods } from './types';\nimport { createLogger } from './logger';\nimport { SegmentClient } from './analytics';\nimport { SovranStorage } from './storage';\n\nexport const createClient = (config: Config) => {\n  const logger = createLogger();\n  if (typeof config?.debug === 'boolean') {\n    if (config.debug) {\n      logger.enable();\n    } else {\n      logger.disable();\n    }\n  }\n  const clientConfig = { ...defaultConfig, ...config };\n\n  const segmentStore = new SovranStorage(config.writeKey);\n\n  const client = new SegmentClient({\n    config: clientConfig,\n    logger,\n    store: segmentStore,\n  });\n\n  client.init();\n\n  return client;\n};\n\nconst Context = createContext<SegmentClient | null>(null);\n\nexport const AnalyticsProvider = ({\n  client,\n  children,\n}: {\n  client?: SegmentClient;\n  children?: any;\n}) => {\n  if (!client) {\n    return null;\n  }\n\n  return <Context.Provider value={client}>{children}</Context.Provider>;\n};\n\nexport const useAnalytics = (): ClientMethods => {\n  const client = useContext(Context);\n  if (!client) {\n    console.error(\n      'Segment client not configured!',\n      'To use the useAnalytics() hook, pass an initialized Segment client into the AnalyticsProvider'\n    );\n\n    // @ts-ignore\n    return {};\n  }\n  return {\n    screen: (...args) => client.screen(...args),\n    track: (...args) => {\n      console.log('PAPAPA', args);\n      client.track(...args);\n    },\n    identify: (...args) => client.identify(...args),\n    flush: () => client.flush(),\n    group: (...args) => client.group(...args),\n    alias: (...args) => client.alias(...args),\n    reset: () => client.reset(),\n  };\n};\n"]}